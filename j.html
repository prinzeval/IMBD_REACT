<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="Content-Security-Policy"
            content="default-src 'self'; frame-src https://vidlink.pro; script-src 'self' 'unsafe-inline'; object-src 'none'; base-uri 'self'; form-action 'none';">
        <title>Video Player</title>
        <style>
            body {
                margin: 0;
                padding: 0;
                background: #000;
            }

            iframe {
                display: block;
                width: 100%;
                height: 100vh;
                border: none;
            }
        </style>
    </head>

    <body>
        <iframe width="100%" height="600" src="https://vidlink.pro/movie/755898" frameborder="0" allowfullscreen
            referrerpolicy="no-referrer-when-downgrade" loading="lazy">
        </iframe>

        <script>
            // Redirect pop-ups to current window instead of new tabs
            (function () {
                // Override window.open to navigate in current window
                const originalOpen = window.open;
                window.open = function (url, target, features) {
                    if (url && url !== 'about:blank') {
                        console.log('Redirecting pop-up to current window:', url);
                        // Navigate current window to the URL instead of opening new tab
                        window.location.href = url;
                        return window;
                    }
                    return null;
                };

                // Monitor for new windows and redirect them
                let windowCheckCount = 0;
                const checkInterval = setInterval(() => {
                    windowCheckCount++;
                    try {
                        // Check if we're in a popup window and redirect parent
                        if (window.opener && window.opener !== window) {
                            try {
                                // If we're in a popup, redirect the opener instead
                                if (window.opener.location) {
                                    window.opener.location.href = window.location.href;
                                    window.close();
                                }
                            } catch (e) {
                                // Cross-origin, can't access opener
                            }
                        }

                        // Monitor for focus changes that might indicate new window
                        if (document.hidden && windowCheckCount % 10 === 0) {
                            window.focus();
                        }
                    } catch (e) {
                        // Ignore errors
                    }
                }, 100);

                // Block beforeunload
                window.addEventListener('beforeunload', function (e) {
                    e.preventDefault();
                    e.returnValue = '';
                }, { capture: true });

                // Block blur events that might trigger pop-ups
                let blurBlocked = false;
                window.addEventListener('blur', function (e) {
                    if (!blurBlocked) {
                        blurBlocked = true;
                        setTimeout(() => {
                            window.focus();
                            blurBlocked = false;
                        }, 10);
                    }
                }, { capture: true });

                // Block focus events from iframe
                window.addEventListener('focus', function (e) {
                    e.stopPropagation();
                }, { capture: true });

                // Block message events that might trigger pop-ups
                window.addEventListener('message', function (e) {
                    // Only allow messages from vidlink.pro
                    if (!e.origin.includes('vidlink.pro')) {
                        e.stopPropagation();
                        return false;
                    }
                }, { capture: true });

                // Redirect links that would open new windows to current window
                document.addEventListener('click', function (e) {
                    const target = e.target;
                    // Only handle if it's not inside the iframe
                    if (target && target.closest && !target.closest('iframe')) {
                        let link = target.closest('a');
                        if (link && link.target === '_blank') {
                            e.preventDefault();
                            e.stopPropagation();
                            if (link.href) {
                                window.location.href = link.href;
                            }
                            return false;
                        }
                    }
                }, { capture: true });

                // Cleanup on page unload
                window.addEventListener('unload', function () {
                    clearInterval(checkInterval);
                });
            })();
        </script>
    </body>

</html>